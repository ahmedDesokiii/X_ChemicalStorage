@using Microsoft.AspNetCore.Identity
@using X_ChemicalStorage.Constants
@using X_ChemicalStorage.Models
@inject IAuthorizationService AuthorizationService
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@inject RoleManager<ApplicationRole> RoleManager
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - ChemicalStorage</title>
    <script type="importmap"></script>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/X_ChemicalStorage.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- custom theame -->
    <link rel="icon" type="image/x-icon" href="~/images/logooo.ico">
    <link href="~/css/bootstrap.min_lumen.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">


    <!-- custom arabic font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Beiruti:wght@200..900&display=swap">
    
    <!-- custom datatable css : ah-desoki-->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.3.4/css/dataTables.dataTables.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/columncontrol/1.1.1/css/columnControl.dataTables.css" />

    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/3.2.5/css/buttons.dataTables.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/select/3.1.3/css/select.dataTables.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/datetime/1.6.1/css/dataTables.dateTime.min.css" />

    <!-- custom datatable js : ah-desoki -->
    <script src="https://code.jquery.com/jquery-3.7.1.js" asp-append-version="true"></script>
    <script src=" https://cdn.datatables.net/2.3.4/js/dataTables.js" asp-append-version="true"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://cdn.datatables.net/plug-ins/2.3.4/api/sum().js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.2/moment.min.js   "></script>
    <script src="https://cdn.datatables.net/datetime/1.5.6/js/dataTables.dateTime.min.js "></script>
    <script src="https://cdn.datatables.net/columncontrol/1.1.1/js/dataTables.columnControl.js"></script>
    <script src="https://cdn.datatables.net/columncontrol/1.1.1/js/columnControl.dataTables.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://cdn.datatables.net/plug-ins/2.3.4/api/sum().js"></script>

</head>
<body>
    <div class="py-1 " style="background-color:#BBE0EF">
        <a href="#" src=""></a>
    </div>
    <header class="main-header sticky-top">
        <nav class="navbar navbar-expand-sm navbar-dark">
            <div class="container-fluid">

                <!-- Logo -->
                <a asp-controller="Home" asp-action="Index" class="navbar-brand">
                    <img src="~/images/logo0.png" alt="Logo">
                </a>

                <!-- Mobile Button -->
                <button class="navbar-toggler" type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#mainNavbar"
                        aria-controls="mainNavbar"
                        aria-expanded="false"
                        aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Menu -->
                <div class="collapse navbar-collapse" id="mainNavbar">
                    <ul class="navbar-nav me-auto mb-2 mb-sm-0 text-center">

                        @if (SignInManager.IsSignedIn(User))
                        {
                            @* Admin Links *@
                            @if (User.IsInRole(Roles.Admin.ToString()))
                            {
                                <li class="nav-item mx-2">
                                    <a class="nav-link fs-5" asp-controller="Users" asp-action="Index">
                                        <i class="bi bi-people-fill fs-4"></i><br />Users
                                    </a>
                                </li>
                                <li class="nav-item mx-2">
                                    <a class="nav-link fs-5" asp-controller="Roles" asp-action="Index">
                                        <i class="bi bi-collection-fill fs-4"></i><br />Roles
                                    </a>
                                </li>
                                <li class="nav-item mx-2">
                                    <a class="nav-link fs-5" asp-controller="Home" asp-action="MasterDashboard">
                                        <i class="bi bi-speedometer fs-4"></i><br />Dashboard
                                    </a>
                                </li>
                            }

                            @* Inventory Links *@
                            <li class="nav-item mx-2">
                                <a class="nav-link fs-5" asp-controller="Items" asp-action="Index">
                                    <i class="bi bi-boxes fs-4"></i><br />Inventory Catalog
                                </a>
                            </li>
                            <li class="nav-item mx-2">
                                <a class="nav-link fs-5" asp-controller="Lots" asp-action="Index">
                                    <i class="bi bi-archive-fill fs-4"></i><br />Inventory Lots
                                </a>
                            </li>

                            @* Services Dropdown *@
                            <li class="nav-item dropdown mx-2">
                                <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="bi bi-database-fill-gear fs-4"></i><br />Services
                                </a>
                                <ul class="dropdown-menu">
                                    @if ((AuthorizationService.AuthorizeAsync(User, Permissions.Suppliers.View).Result.Succeeded))
                                    {
                                        <li><a class="dropdown-item" asp-controller="Suppliers" asp-action="Index">Suppliers</a></li>
                                    }
                                    @if ((AuthorizationService.AuthorizeAsync(User, Permissions.Categories.View).Result.Succeeded))
                                    {
                                        <li><a class="dropdown-item" asp-controller="Categories" asp-action="Index">Categories</a></li>
                                    }
                                    @if ((AuthorizationService.AuthorizeAsync(User, Permissions.Units.View).Result.Succeeded))
                                    {
                                        <li><a class="dropdown-item" asp-controller="Units" asp-action="Index">Units</a></li>
                                    }
                                    @if ((AuthorizationService.AuthorizeAsync(User, Permissions.Manufacuters.View).Result.Succeeded))
                                    {
                                        <li><a class="dropdown-item" asp-controller="ManufacuterCompanies" asp-action="Index">Manufacturers</a></li>
                                    }
                                    @if ((AuthorizationService.AuthorizeAsync(User, Permissions.Locations.View).Result.Succeeded))
                                    {
                                        <li><a class="dropdown-item" asp-controller="Locations" asp-action="Index">Locations</a></li>
                                    }
                                </ul>
                            </li>
                        }
                    </ul>

                    <partial name="_NotifyPartial" />
                    <partial name="_LoginPartial" />
                </div>
            </div>
        </nav>
    </header>

    <div class="container-fluid pt-0  px-0 mx-0" dir="rtl">
        <main role="main" class="pb-0 ">
            @RenderBody()
        </main>
    </div>
    @* <footer class=" border-top footer text-muted " style="background-color:#032b42 !important;border-radius:0 80px 0 0">
    <div class="container-fluid  text-center">

        <a asp-area="" asp-controller="" asp-action="" class="fw-bold px-2 link-underline-opacity-0"> ادارة النظـم</a> <span class="text-light fw-light">&copy; ERP [ PackLine | Frist ] 2025 </span>
    </div>
</footer> *@
   
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/Users.js" asp-append-version="true"></script>
    <script src="~/js/Roles.js" asp-append-version="true"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts" asp-append-version="true"></script>
    @* sweetalert liberary to pop msg*@
    <script src="~/sweetalert2/sweetalert2.all.js"></script>
    <script src="~/sweetalert2/sweetalert2.all.min.js"></script>
    <script src="~/sweetalert2/sweetalert2.esm.all.js"></script>
    <script src="~/sweetalert2/sweetalert2.esm.all.min.js"></script>
    <script src="~/sweetalert2/sweetalert2.esm.js"></script>
    <script src="~/sweetalert2/sweetalert2.esm.min.js"></script>
    <script src="~/sweetalert2/sweetalert2.js"></script>
    <script src="~/sweetalert2/sweetalert2.min.js"></script>
   
    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>
