@* @model MasterViewModel
@{
    var DemandsData = Model.DemandVM.Demands;
    int? notify = 0;
}
@if (User.IsInRole(Roles.Admin.ToString()))
{
    DemandsData = Model.DemandVM.Demands;
    notify = Model.DemandVM.DemandsForMen_Notify.Count + Model.DemandVM.DemandsForWomen_Notify.Count;
}
else if (User.IsInRole(Roles.Supervisor.ToString()))
{
    DemandsData = Model.DemandVM.DemandsForMen;
    notify = Model.DemandVM.DemandsForMen_Notify.Count;

}
else if (User.IsInRole(Roles.SupervisorWomen.ToString()))
{
    DemandsData = Model.DemandVM.DemandsForWomen;
    notify = Model.DemandVM.DemandsForWomen_Notify.Count;

}
else if (User.IsInRole(Roles.Teacher.ToString()) || User.IsInRole(Roles.TeacherWomen.ToString()))
{
    DemandsData = Model.DemandVM.DemandsForTeacher;
    notify = Model.DemandVM.DemandsForTeacher_Notify.Count;

} *@

<style>
    a.dropdown-toggle::after {
        content: none;
    }
</style>

<ul class="navbar-nav">
    <li class="nav-item mt-2">
        <div class="dropdown ">
            <a data-mdb-dropdown-init
               class="text-reset dropdown-toggle"
               id="notifications"
               role="button"
               aria-expanded="false">
                <h3><i class="bi bi-bell-fill text-light"></i></h3>
            </a>
            <span id="notifications" class="position-absolute top-0 start-100 translate-middle badge rounded bg-danger">
                <span>1</span> <span class="visually-hidden me-4">notify</span>
            </span>
            <ul class="dropdown-menu dropdown-menu-end py-0"
                aria-labelledby="notifications" id="notificationsList">

                @* @if (!DemandsData.Any())
                {
                    <li>
                        <a class="dropdown-item text-center" href="#">لا يوجد اي اشعارات</a>
                    </li>
                }
                else if (User.IsInRole(Roles.Parent.ToString()))
                {
                    <li>
                        <a class="dropdown-item text-center" href="#">لا يوجد اي اشعارات</a>
                    </li>
                }
                else
                {
                    @foreach (var notif in DemandsData)
                    {
                        if (notif.IsOpened == false)
                        {
                            if (notif.Request_Type.Contains("طلب تعديل بيانات"))
                            {
                                <li class="bg-danger-subtle">
                                    <a class="dropdown-item text-end" asp-action="SelectedDemand" asp-controller="Demands" asp-route-Id="@notif.Id">
                                        <i class="bi bi-envelope-fill text-warning"></i>
                                        <span class="fw-bold text-warning me-2" style="font-size:14px">@notif.Request_Type</span><br>
                                        <span class="text-dark" style="font-size:13px">@notif.Student.Name</span><br>
                                        <span class="text-dark" style="font-size:13px">@Convert.ToDateTime(notif.Request_Date).Date.ToString("yyyy/MM/dd")</span>
                                    </a>
                                </li>
                                <hr class="my-0 mx-1 p-0">
                            }
                            else if (notif.Request_Type.Contains("طلب إضافة طالب جديد"))
                            {
                                <li class="bg-success-subtle">
                                    <a class="dropdown-item text-end" asp-action="SelectedDemand" asp-controller="Demands" asp-route-Id="@notif.Id">
                                        <i class="bi bi-envelope-fill text-success"></i>
                                        <span class="fw-bold text-success me-2" style="font-size:14px">@notif.Request_Type</span><br>
                                        <span class="text-dark" style="font-size:13px">@notif.Student.Name</span><br>
                                        <span class="text-dark" style="font-size:13px">@Convert.ToDateTime(notif.Request_Date).Date.ToString("yyyy/MM/dd")</span>
                                    </a>
                                </li>
                                <hr class="my-0 mx-1 p-0">
                            }
                            else
                            {
                                <li class="bg-info-subtle">
                                    <a class="dropdown-item text-end" asp-action="SelectedDemand" asp-controller="Demands" asp-route-Id="@notif.Id">
                                        <i class="bi bi-envelope-fill text-primary"></i>
                                        <span class="fw-bold text-primary me-2" style="font-size:14px">@notif.Request_Type</span><br>
                                        <span class="text-dark" style="font-size:13px">@notif.Student.Name</span><br>
                                        <span class="text-dark" style="font-size:13px">@Convert.ToDateTime(notif.Request_Date).Date.ToString("yyyy/MM/dd")</span>
                                    </a>
                                </li>
                                <hr class="my-0 mx-1 p-0">
                            }
                        }
                        else
                        {
                            <li class="bg-white">
                                <a class="dropdown-item text-end" asp-action="SelectedDemand" asp-controller="Demands" asp-route-Id="@notif.Id">
                                    <i class="bi bi-envelope-open-fill text-dark"></i>
                                    <span class="fw-bold text-dark me-2" style="font-size:14px">@notif.Request_Type</span><br>
                                    <span class="text-dark" style="font-size:13px">@notif.Student.Name</span><br>
                                    <span class="text-dark" style="font-size:13px">@Convert.ToDateTime(notif.Request_Date).Date.ToString("yyyy/MM/dd")</span>
                                </a>
                            </li>
                            <hr class="my-0 mx-1 p-0">
                        }
                    }

                    <a class="text-danger" style="text-decoration-line:none;font-size:14px;" asp-action="Demands" asp-controller="Demands">
                        عرض كل الإشعارات &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    </a>



                } *@
            </ul>
        </div>
    </li>
</ul>

<script>
    /*
    $(document).ready(function(){
        $('#notifications').on('click',function(){
            $('#notificationsList').toggle();
        });
    });

     // Example using plain JavaScript
    const list = document.querySelector('#notificationsList');
    const items = list.querySelectorAll('li');
    const limit = 6; // Number of items to show initially

    if (items.length > limit) {
        for (let i = limit; i < items.length; i++) {
            items[i].style.display = 'none';
        }
        // // Add a "Show More" button
        // const showMoreButton = document.createElement('button');
        // showMoreButton.textContent = 'Show More';
        // list.parentNode.appendChild(showMoreButton);

        // showMoreButton.addEventListener('click', () => {
        //     for (let i = limit; i < items.length; i++) {
        //         items[i].style.display = 'list-item'; // or 'block'
        //     }
        //     showMoreButton.style.display = 'none'; // Hide the button after showing all
        //     // Optionally, add a "Show Less" button
        // });
    }
    */
</script>