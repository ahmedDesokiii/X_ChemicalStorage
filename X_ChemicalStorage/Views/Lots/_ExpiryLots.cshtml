@model LotViewModel
@{
    int cNo = 0;
}


<!-- Modal -->
<div class="modal fade bd-example-modal-lg" id="ExpieryLotsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" dir="ltr">
    <div class="modal-dialog modal-lg card card-success card-outline">
        <div class="modal-content">
            <div class="modal-header" style="background-color:#758A93" dir="ltr">
                <span class="fs-4 fw-bold modal-title" id="">Expiry Lots</span>
                <a href="#" class="btn-close position-absolute  end-0 mx-3" data-bs-dismiss="modal" aria-label="Close"></a>
            </div>
            <div class="modal-body">
                @if (!Model.ExpiryLotsList.Any())
                {
                    <div class="alert  alert-warning mt-5">
                        <h4 class="alert-heading">No Expiry Lots</h4>
                        <p class="mb-0">No Expiry Lots have been added to the app yet.</p>
                    </div>
                }
                else
                {
                    <div id="Roles" class="tabcontent mx-2">
                        <table class="table table-hover display nowrap  px-0 table-bordered border-primary-subtle" id="tableRole">
                            <thead>
                                <tr class="text-center">
                                    <th class=" text-white text-center px-0 fs-5" style="background-color:#CB6040 !important;" >Lot Number</th>
                                    <th class=" text-white text-center px-0 fs-5" style="background-color:#CB6040 !important;" >Item</th>
                                    <th class=" text-white text-center px-0 fs-5" style="background-color:#CB6040 !important;" >Expiry Date</th>
                                    <th class=" text-white text-center px-0 fs-6" style="background-color:#CB6040 !important;" >Total<br class="m-0 p-0">Quantity</th>
                                    <th class=" text-white text-center px-0 fs-5" style="background-color:#CB6040 !important;" >Location</th>
                                    <th class=" text-white text-center px-0 fs-5" style="background-color:#CB6040 !important;" >Lot SDS</th>
                                    <th class=" text-white text-center px-0 fs-6" style="background-color:#CB6040 !important;" >Manufacture <br class="m-0 p-0">Date</th>
                                    <th class=" text-white text-center px-0 fs-6" style="background-color:#CB6040 !important;">Actions</th>

                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var lot in Model.ExpiryLotsList)
                                {
                                    cNo++;
                                    <tr class="text-center ">
                                        <td class="fs-6 text-center px-1 bg-light-subtle">
                                            <span class="link-dark fw-bold fs-6"> <img src="@lot.BarcodeImage" style="height:40px" /></span>
                                            <hr class="p-0 m-0">
                                            <span class="link-dark " style="font-size:10px">@lot.LotNumber</span>
                                        </td>
                                        <td class="fs-6 text-center px-1 bg-light-subtle">
                                            @if (AuthorizationService.AuthorizeAsync(User, Permissions.Items.Details_Items).Result.Succeeded)
                                            {
                                            <a class="link-primary fw-bold text-decoration-none" title="Item Details" asp-controller="Items" asp-action="SelectedItem" asp-route-Id="@lot.ItemId">
                                                    @lot.Item?.Name
                                            </a>
                                            }
                                            else
                                            {
                                            <span class="link-primary fw-bold text-decoration-none" title="Item Details">
                                                @lot.Item?.Name
                                            </span>
                                            }
                                        </td>
                                        <td class="fs-6 text-center px-1 bg-light-subtle"><span class="fw-bold link-danger">@Convert.ToDateTime(lot.ExpiryDate).ToShortDateString()</span></td>
                                        <td class="fs-6 text-center px-1 bg-light-subtle"><span class="link-dark fw-bold">@lot.TotalQuantity</span></td>
                                        <td class="fs-6 text-center px-1 bg-light-subtle"><span class="link-dark fw-bold">Room[@lot.Location?.RoomNum]</span></td>
                                            @if (lot.SDS == true)
                                            {
                                            <td class="text-center bg-light-subtle">
                                                    <span class="fw-bold py-2 px-3 bg-success-subtle link-success rounded-5">
                                                        Valid
                                                    </span>
                                                </td>
                                            }
                                            else
                                            {
                                            <td class="text-center bg-light-subtle">
                                                    <span class="fw-bold py-2 px-3 bg-danger-subtle link-danger rounded-5">
                                                        Invalid
                                                    </span>
                                                </td>
                                            }
                                        
                                        <td class="fs-6 text-center px-1 bg-light-subtle"><span class="link-dark ">@Convert.ToDateTime(lot.ManufactureDate).ToShortDateString()</span></td>
                                        <td class="fs-6 text-center px-1 bg-light-subtle">
                                            @if (AuthorizationService.AuthorizeAsync(User, Permissions.Lots.Details_Lots).Result.Succeeded)
                                            {
                                                <a class="btn fw-bold btn-outline-dark bg-transparent border-0 text-center p-0 mx-1 fs-5" title="Details" asp-controller="Lots" asp-action="SelectedLot" asp-route-Id="@lot.Id"><i class="bi bi-eye-fill fs-4"></i><br></a>
                                            }
                                        </td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>
                }

            </div>

        </div>
    </div>
</div>

